\documentclass[11pt,openany,oneside,letterpaper]{book_tesis}
\usepackage[spanish]{babel}
%\usepackage[utf8]{inputenc}
\usepackage{fontspec}			% Necesario para XeLaTeX o LuaLaTeX
\usepackage{setspace}           % Interlineado
\usepackage{titletoc}			% Formato del indice
\usepackage{titlesec}			% Formato del indice
\usepackage[left=2.54cm, right=2.54cm, top=2.54cm, bottom=2.54cm]{geometry}

\usepackage{graphicx}  % Para insertar imágenes
\usepackage{caption}   % Para personalizar leyendas
\usepackage{float}     % Para control de posicionamiento de figuras
\usepackage{booktabs}   % Para líneas horizontales en
\usepackage{array}      % Para personalizar alineación en columnas
\usepackage{longtable} % Paquete para tablas largas
\usepackage{multirow} % para unión de filas en las tablas

\usepackage{changepage} % Para ajustar márgenes

\usepackage{listings} % Para mostrar código fuente
\usepackage{xcolor}  % Para colores

\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage[backend=biber, style=apa]{biblatex} % Para usar bibliografia
\usepackage{csquotes}
\usepackage{enumitem}			% para las listas 
\usepackage[nopatch=item]{microtype}		% Para que no salga error de polyglossia
\usepackage{lipsum} % Carga el paquete lipsum
\usepackage{microtype}
\usepackage{hyperref} % Para enlaces a los capitulos secciones en el indice
\usepackage{changepage} % Para ajustar márgenes

% \usepackage{showframe}                % Para ver lineas de margenes

\definecolor{gris}{gray}{0.95}

\addbibresource{parte_final/bibliografia.bib}

\setmainfont{georgia} 			% Configura la fuente principal como Georgia

\setlength{\parskip}{0.1mm}           % Espacio entre párrafos
\setlength{\parindent}{36.1315pt}     % Indentación de los párrafos
\setlength{\baselineskip}{0em} % Ajusta el espacio entre líneas

\pagestyle{myheadings}

% Cambiar "Cuadro" a "Tabla"
\addto\captionsspanish{\renewcommand{\tablename}{Tabla}}
% Cambiar "Índice de Cuadros" a "Índice de Tablas"
\addto\captionsspanish{\renewcommand{\listtablename}{ÍNDICE DE TABLAS}}
% Cambiar "Índice de figuras" a "ÍNDICE DE FIGURAS"
\addto\captionsspanish{\renewcommand{\listfigurename}{ÍNDICE DE FIGURAS}}

\assignpagestyle{\chapter}{empty} % Para que las hojas de los capítulos no sean numeradas

% Ajustar el espaciado vertical entre los capítulos en el índice
\titlecontents{chapter}[0pt]{\addvspace{1pt}\bfseries}{\thecontentslabel.\hspace{1.6em}}{}{\titlerule*[0.5pc]{.}\contentspage}
\titlecontents{section}[0pt]{}{\thecontentslabel.\hspace{1em}}{}{\titlerule*[0.5pc]{.}\contentspage}
\titlecontents{subsection}[28pt]{}{\thecontentslabel.\hspace{1em}}{}{\titlerule*[0.5pc]{.}\contentspage}

% Cambiar los títulos de los capítulos a mayúsculas
% \titleformat{\chapter}[display]
%{\normalfont\fontsize{13pt}{42pt}\selectfont\bfseries}{\MakeUppercase{\chaptertitlename}\ \thechapter}{-110pt}{\fontsize{13pt}{70pt}\selectfont}

\titleformat{\chapter}
{\normalfont\fontsize{13pt}{60pt}\selectfont\bfseries}{\thechapter}{24pt}{\fontsize{13pt}{0pt}\selectfont}

\titleformat{\section}{\bfseries\normalsize}{\thesection.}{16pt}{}
\titleformat{\subsection}{\bfseries\normalsize}{\thesubsection.}{9pt}{}

\titlespacing*{\chapter}{0pt}{*0}{0pt}
\titlespacing*{\section}{0pt}{*0}{0pt}
\titlespacing*{\subsection}{0pt}{*0}{0pt}

% Definir un nuevo estilo de numeración para los capítulos
% \renewcommand{\thechapter}{\Roman{chapter}}

% Configuración de hyperref para desactivar colores y cuadros
\hypersetup{
	colorlinks=false, % Desactiva el color de los enlaces
	pdfborder={0 0 0}, % Desactiva los cuadros alrededor de los enlaces
}

\captionsetup[figure]{
	margin={1.27cm,0cm},
	justification=RaggedRight, % Alineación a la izquierda
	singlelinecheck=false,     % Permite leyendas de múltiples líneas
	labelfont=bf,              % Fuente de etiqueta en negrita
	textfont=it,         	% Fuente en cursiva para texto
	labelsep=newline,           % Separador es un punto
}

\captionsetup[table]{
	margin={1.27cm,0cm},
	labelfont=bf,
	labelsep=newline,
	justification=RaggedRight,
	singlelinecheck=false,     % Permite leyendas de múltiples líneas
	textfont=it,      % Texto de la leyenda en cursiva
	% position=top,     % Leyenda arriba de la tabla
	% skip=0pt          % Sin espacio entre la leyenda y la tabla
}

\captionsetup[longtable]{
	margin={1.27cm,0cm},
	labelfont=bf,
	labelsep=newline,
	justification=RaggedRight,
	singlelinecheck=false,     % Permite leyendas de múltiples líneas
	textfont=it,      % Texto de la leyenda en cursiva
	% position=top,     % Leyenda arriba de la tabla
	skip=17pt          % Sin espacio entre la leyenda y la tabla
}

\makeatletter
\renewcommand\listoffigures{%
	\chapter*{\hfill\bfseries\normalsize ÍNDICE DE FIGURAS\hfill} % Título centrado
	\addcontentsline{toc}{chapter}{\listfigurename}%
	\noindent\hspace{0.6cm}\textbf{Fig.} \hfill \textbf{Descripción} \hfill \textbf{Pag.} \hfill % Encabezados
	\par\vspace{-0.2cm} % Espacio entre encabezados y el listado
	\@starttoc{lof}%
}
\makeatother

% Modificar el formato del índice de tablas
\makeatletter
\renewcommand\listoftables{%
	\chapter*{\hfill\bfseries\normalsize ÍNDICE DE TABLAS\hfill} % Título centrado
	\addcontentsline{toc}{chapter}{\listtablename}%
	\noindent\hspace{0.6cm}\textbf{Tabla} \hfill \textbf{Descripción} \hfill \textbf{Pag.} \hfill % Encabezados
	\par\vspace{-0.2cm} % Espacio entre encabezados y el listado
	\@starttoc{lot}%
}
\makeatother

\lstset{
	language=Python,
	basicstyle=\ttfamily\small, % Formato del código
	frame=single, % Marco alrededor del código
	tabsize=3,
	keywordstyle=\color{violet}\bfseries,  % Palabras clave en azul y negrita
	commentstyle=\color{olive},  % Comentarios en verde
	stringstyle=\color{cyan},  % Cadenas de texto en rojo
	backgroundcolor=\color{gris},  % Fondo gris claro
	breakatwhitespace=false,         % Activarlo para que los saltos automáticos solo se apliquen en los espacios en blanco
	breaklines=true,                 % Activa el salto de línea automático
	%xleftmargin=2.54cm, % Márgenes desde la izquierda
	%framexleftmargin=2.54cm, % Espacio para el marco
}


\begin{document}
	\spacing{2}                     % Interlineado
	\frontmatter
	\pagenumbering{gobble} % Eliminar numeración de página del índice
	\include{caratula}
	\thispagestyle{empty}
	\sloppy
	% Dedicatoria
	%\include{parte_inicial/dedicatoria}
	% Agradecimientos
	%\include{parte_inicial/agradecimientos}
	% Resumen
	
	\include{capitulos/resumen.tex}
	
	
	\clearpage
	\renewcommand{\contentsname}{\hfill\bfseries\normalsize CONTENIDO\hfill}
	\tableofcontents
	\thispagestyle{empty}
	\addtocontents{toc}{~\hfill\textbf{Pág.}\par}
	
	\addcontentsline{toc}{chapter}{RESUMEN} % Agregar al índice general
	
	% Índice de Figuras
	\listoffigures
	
	
	% Índice de Tablas
	\listoftables
	
	\mainmatter
	% Introduccción
	\setcounter{page}{1}
	\include{capitulos/introduccion}
	% Marco teórico
	\include{capitulos/marco_teorico}
	% Marco aplicativo
	\include{capitulos/marco_aplicativo}
	% Calidad y seguridad
	\include{capitulos/calidad_seguridad}
	% jConclusiones y recomendaciones
	\include{capitulos/conclusiones_recomendaciones}
	
	\backmatter
	% Bibliografía
	\include{parte_final/bibliografia}
\end{document}